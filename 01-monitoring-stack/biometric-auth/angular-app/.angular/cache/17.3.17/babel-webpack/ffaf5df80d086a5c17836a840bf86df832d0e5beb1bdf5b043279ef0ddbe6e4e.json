{"ast":null,"code":"import _asyncToGenerator from \"/Users/domoblock/Documents/Projycto/sec-observe-lab/01-monitoring-stack/biometric-auth/angular-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventEmitter } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { MatCardModule } from '@angular/material/card';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/biometric.service\";\nimport * as i2 from \"@angular/material/snack-bar\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/card\";\nimport * as i5 from \"@angular/material/button\";\nimport * as i6 from \"@angular/material/icon\";\nimport * as i7 from \"@angular/material/progress-spinner\";\nfunction QrCodeComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"div\", 8)(2, \"mat-icon\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵclassProp(\"success\", ctx_r0.currentStatus.success)(\"error\", !ctx_r0.currentStatus.success);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.currentStatus.success ? \"check_circle\" : \"error\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r0.currentStatus.method, \": \", ctx_r0.currentStatus.success ? \"Exitoso\" : \"Fall\\u00F3\", \"\");\n  }\n}\nfunction QrCodeComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"h4\");\n    i0.ɵɵtext(2, \"\\uD83D\\uDCF1 C\\u00F3digo QR Generado:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"img\", 10);\n    i0.ɵɵelementStart(4, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function QrCodeComponent_div_20_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.validateQR());\n    });\n    i0.ɵɵelementStart(5, \"mat-icon\");\n    i0.ɵɵtext(6, \"check_circle\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \" Validar QR \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"src\", ctx_r0.qrCodeUrl, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", ctx_r0.isLoading);\n  }\n}\nfunction QrCodeComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵelement(1, \"mat-spinner\", 13);\n    i0.ɵɵelementStart(2, \"p\");\n    i0.ɵɵtext(3, \"Procesando QR...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let QrCodeComponent = /*#__PURE__*/(() => {\n  class QrCodeComponent {\n    constructor(biometricService, snackBar) {\n      this.biometricService = biometricService;\n      this.snackBar = snackBar;\n      this.username = '';\n      this.statusChange = new EventEmitter();\n      this.isLoading = false;\n      this.currentStatus = null;\n      this.qrCodeUrl = '';\n      this.qrData = '';\n    }\n    ngOnInit() {\n      if (this.username) {\n        console.log('QR Code component initialized for:', this.username);\n      }\n    }\n    generateQR() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        if (!_this.username) {\n          _this.snackBar.open('❌ Usuario requerido', 'Cerrar', {\n            duration: 3000\n          });\n          return;\n        }\n        _this.isLoading = true;\n        try {\n          const result = yield _this.biometricService.generateQRCode(_this.username, `qr-data-${Date.now()}`);\n          _this.currentStatus = result;\n          _this.statusChange.emit(result);\n          if (result.success && result.data) {\n            _this.qrCodeUrl = result.data.qrCodeUrl;\n            _this.qrData = result.data.data;\n            _this.snackBar.open('✅ QR generado correctamente', 'Cerrar', {\n              duration: 3000\n            });\n          } else {\n            _this.snackBar.open(`❌ Error: ${result.error}`, 'Cerrar', {\n              duration: 5000\n            });\n          }\n        } catch (error) {\n          _this.snackBar.open(`❌ Error: ${error.message}`, 'Cerrar', {\n            duration: 5000\n          });\n        } finally {\n          _this.isLoading = false;\n        }\n      })();\n    }\n    validateQR() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        if (!_this2.qrData) {\n          _this2.snackBar.open('❌ No hay QR para validar', 'Cerrar', {\n            duration: 3000\n          });\n          return;\n        }\n        _this2.isLoading = true;\n        try {\n          const result = yield _this2.biometricService.validateQRCode(_this2.username, _this2.qrData);\n          _this2.currentStatus = result;\n          _this2.statusChange.emit(result);\n          if (result.success) {\n            _this2.snackBar.open('✅ QR validado correctamente', 'Cerrar', {\n              duration: 3000\n            });\n          } else {\n            _this2.snackBar.open(`❌ Error: ${result.error}`, 'Cerrar', {\n              duration: 5000\n            });\n          }\n        } catch (error) {\n          _this2.snackBar.open(`❌ Error: ${error.message}`, 'Cerrar', {\n            duration: 5000\n          });\n        } finally {\n          _this2.isLoading = false;\n        }\n      })();\n    }\n    static {\n      this.ɵfac = function QrCodeComponent_Factory(t) {\n        return new (t || QrCodeComponent)(i0.ɵɵdirectiveInject(i1.BiometricService), i0.ɵɵdirectiveInject(i2.MatSnackBar));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: QrCodeComponent,\n        selectors: [[\"app-qr-code\"]],\n        inputs: {\n          username: \"username\"\n        },\n        outputs: {\n          statusChange: \"statusChange\"\n        },\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 22,\n        vars: 4,\n        consts: [[1, \"qr-container\"], [1, \"qr-card\"], [\"class\", \"status-section\", 4, \"ngIf\"], [1, \"test-section\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\", \"disabled\"], [\"class\", \"qr-display\", 4, \"ngIf\"], [\"class\", \"loading-section\", 4, \"ngIf\"], [1, \"status-section\"], [1, \"status-item\"], [1, \"qr-display\"], [\"alt\", \"QR Code\", 1, \"qr-image\", 3, \"src\"], [\"mat-raised-button\", \"\", \"color\", \"accent\", 3, \"click\", \"disabled\"], [1, \"loading-section\"], [\"diameter\", \"40\"]],\n        template: function QrCodeComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"mat-card\", 1)(2, \"mat-card-header\")(3, \"mat-card-title\")(4, \"mat-icon\");\n            i0.ɵɵtext(5, \"qr_code\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(6, \" C\\u00F3digo QR \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"mat-card-subtitle\");\n            i0.ɵɵtext(8, \" Genera y valida c\\u00F3digos QR para autenticaci\\u00F3n \");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(9, \"mat-card-content\");\n            i0.ɵɵtemplate(10, QrCodeComponent_div_10_Template, 6, 7, \"div\", 2);\n            i0.ɵɵelementStart(11, \"div\", 3)(12, \"h3\");\n            i0.ɵɵtext(13, \"\\uD83D\\uDCF1 Generar C\\u00F3digo QR\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(14, \"p\");\n            i0.ɵɵtext(15, \"Genera un c\\u00F3digo QR para autenticaci\\u00F3n\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(16, \"button\", 4);\n            i0.ɵɵlistener(\"click\", function QrCodeComponent_Template_button_click_16_listener() {\n              return ctx.generateQR();\n            });\n            i0.ɵɵelementStart(17, \"mat-icon\");\n            i0.ɵɵtext(18, \"qr_code\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(19, \" Generar QR \");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(20, QrCodeComponent_div_20_Template, 8, 2, \"div\", 5)(21, QrCodeComponent_div_21_Template, 4, 0, \"div\", 6);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(10);\n            i0.ɵɵproperty(\"ngIf\", ctx.currentStatus);\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"disabled\", ctx.isLoading);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngIf\", ctx.qrCodeUrl);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n          }\n        },\n        dependencies: [CommonModule, i3.NgIf, FormsModule, MatCardModule, i4.MatCard, i4.MatCardContent, i4.MatCardHeader, i4.MatCardSubtitle, i4.MatCardTitle, MatButtonModule, i5.MatButton, MatIconModule, i6.MatIcon, MatProgressSpinnerModule, i7.MatProgressSpinner, MatSnackBarModule],\n        styles: [\".qr-container[_ngcontent-%COMP%]{padding:1rem}.qr-card[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.status-section[_ngcontent-%COMP%]{margin:1rem 0}.status-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;background:#f5f5f5;margin:10px 0}.status-item.success[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-item.error[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.test-section[_ngcontent-%COMP%]{margin:2rem 0;padding:1.5rem;border:2px solid #f0f0f0;border-radius:15px;transition:var(--transition)}.test-section[_ngcontent-%COMP%]:hover{border-color:var(--primary-color)}.qr-display[_ngcontent-%COMP%]{margin:2rem 0;padding:1.5rem;background:#f8f9fa;border-radius:15px;text-align:center}.qr-image[_ngcontent-%COMP%]{max-width:200px;border:2px solid #ddd;border-radius:10px;margin:1rem 0}.loading-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem;margin:2rem 0}\"]\n      });\n    }\n  }\n  return QrCodeComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}